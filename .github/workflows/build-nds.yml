name: Build NDS

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Install devkitPro toolchain
        run: |
          sudo apt update
          sudo apt install -y curl
          curl -L https://devkitpro.org/setup/devkitpro-installer.sh -o setup-devkitpro.sh
          bash setup-devkitpro.sh
          source /opt/devkitpro/devkitpro-env.sh

      - name: Build NDS example
        run: |
          source /opt/devkitpro/devkitpro-env.sh
          cd nds-examples/hello_world
          make clean
          make

      - name: Upload built NDS
        uses: actions/upload-artifact@v3
        with:
          name: hello_world.nds
          path: nds-examples/hello_world/hello_world.nds
